<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

</head>
<body>
<div class="container">
    <h1>Overview</h1>
    <button id=btnNewBesteldToestel class="btn btn-primary" onclick="window.location.href='CreateBesteldToestel.html'">Create</button>
    <ul id="listToestellen"></ul>
</div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>

<script>
    init();

    function init() {
        if ($('#listToestellen').children().length !== 0) {
            $('#listToestellen').empty();
        }
        $.getJSON('http://localhost:8080/besteldtoestel/besteldetoestellen', function (data) {
            console.log(data);
            $.each(data, function (i, toestel) {
                console.log(toestel.besteldToestelId);
                let link = "DetailBesteldToestel/" + toestel.besteldToestelId + ".html";
                let node = `
                    <li>${toestel.naam} --
                        <button id='btnDetail' data-id='${toestel.besteldToestelId}'  class='btnButtons btn btn-secondary' onclick=window.location.href='DetailBesteldToestel/${toestel.besteldToestelId}.html'>Details</button>
                        <button id='btnDelete' data-id='${toestel.besteldToestelId}' class='btn btn-danger' onclick='deleteToestel(this)'>Delete</button>
                    </li>
                    `;

                $('#listToestellen').append(node);

            })
        });
    }

    function deleteToestel(element) {
        let toestelId = $(element).data('id')
        $.ajax({
            type: 'DELETE',
            url: 'http://localhost:8080/besteldtoestel/deleteBesteldToestel',
            //contentType: 'application/json',
            data: {
                id: toestelId
            },
            success: function (result) {
                //window.location.href ="http://localhost:8080/besteldtoestel/OverviewBesteldeToestellen.html";
                init();
                console.log('SUCCESSFULLY DELETED');
            },
            error: function (jqXhr, textStatus, errorMessage) {
                console.log('ERROR');
            }
        });
    }
</script>
</body>
</html>